%!PS
% MIT license as usual
% English units, 8 point = 1 inch

/in {8 mul} def

% Some setup for relative drawing commands (like turtle graphics, but
% coordinate-aware).
/newcursor {gsave translate newpath 0 0 moveto} def
/cline     {translate 0 0 lineto}               def
/cjump     {translate 0 0 moveto}               def
/endcursor {stroke grestore}                    def

/hline {in 0 cline}            def
/vline {in 0 exch cline}       def
/dline {in exch in exch cline} def

/hjump {in 0 cjump}            def
/vjump {in 0 exch cjump}       def
/djump {in exch in exch cjump} def

/64th {64 div} def
/8th  {8  div} def

/circle {0 exch 0 exch in 0 360 arc} def

/2x4indent {-3.5 vline
             1.5 hline
             3.5 vline} def

0.001 in setlinewidth

% Mattress dimensions:
% queen = 60x80 in
% king = 76x79 in
%
% Because king beds are so wide, it's not really feasible to make one into a
% futon. Math for this below.

% Layout math:
% The total frame width (upper + lower, minus hole offsets) should be either 60
% or 76 inches. The upper hole is offset by 4in and the lower by 3in, for a
% total of 7in lost to overlap.
%
% So for a king frame, upper + lower = 83; queen frame = 67.
%
% End slopes aren't counted as lost, since the mattress should overhang the
% ends by a little; otherwise the slopes protrude past the edge and create a
% tripping hazard. The math here is that the mattress actually overhangs by the
% end-slope plus a couple of inches. The overhang is supported by the slats.
%
% Upper vs lower frame dimensions are tricky due to the way seat depth works.
% Anything between 20 and 22 inches of net seat depth is ideal. If the mattress
% is between 6 and 8 inches thick, then the total lower frame width needs to be
% at most 30 inches from overhang to hinge (so 33 inches total).

% Upper frame beam: one half of the bed when folded down, the back of the futon
% when folded up. Hole offset is -4 from right, -2 from top.
/upperbeam
{
  /upperwidth exch def

  % 3 + 5 + 1.5 + x + 1.5 + 10 = total width
  % x + 21 = total width
  3 8 dline 5 hline 2x4indent upperwidth 21 sub hline 2x4indent
  10 hline

  % 3 + 1 + 3 + 9/8 + x + 5 = total width
  % 13.125 + x = total width
  -3 -8 dline -1 hline 6 vjump 0.375 circle -6 vjump -3 hline 3 vline
  upperwidth 13.125 sub neg hline
  -3 3 mul 8th -8 3 mul 8th dline -5 hline
} def

% Lower frame beam: one half of the bed when folded down, the bottom of the
% futon when folded up.
/lowerbeam
{
  /lowerwidth exch def

  % 8 + 1.5 + x + 1.5 + 7 + 3 = total width
  % 21 + x = total width
  5 vline 8 hline 2x4indent lowerwidth 21 sub hline 2x4indent 7 hline
  3 -8 dline

  % 6 + 6/8 + x + 3 = total width
  % 10 + x = total width
  -6 1 dline -3 2 mul 8th 8 2 mul 8th dline
  lowerwidth 9.75 sub neg hline
  3 vjump 0.375 circle -3 vjump -3 hline
} def

100 100 newcursor 36 upperbeam endcursor
100 220 newcursor 36 lowerbeam endcursor

showpage
